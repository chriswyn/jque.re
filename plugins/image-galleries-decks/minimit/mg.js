function mg_init(options){this["reference"]=options.reference;this["activated"]=typeof(options.activated)!="undefined"?options.activated:[];if(options.click){var interactive_click=options.click.interactive;this[reference+"_activated_click"]=[];this[reference+"_linked_click"]=options.click.linked;this[reference+"_max_activated_click"]=options.click.max_activated;this[reference+"_deactivable_click"]=options.click.deactivable;this[reference+"_less_click"]=options.click.less;this[reference+"_plus_click"]=options.click.plus;this[reference+"_automatic_click"]=options.click.automatic;this[reference+"_automaticpause_click"]=options.click.automaticpause;this[reference+"_automaticinverse_click"]=options.click.automaticinverse}if(options.hover){var interactive_hover=options.hover.interactive;this[reference+"_activated_hover"]=[];this[reference+"_linked_hover"]=options.hover.linked;this[reference+"_max_activated_hover"]=options.hover.max_activated;this[reference+"_deactivable_hover"]=options.hover.deactivable;this[reference+"_less_hover"]=options.hover.less;this[reference+"_plus_hover"]=options.hover.plus;this[reference+"_automatic_hover"]=options.hover.automatic;this[reference+"_automaticpause_hover"]=options.hover.automaticpause;this[reference+"_automaticinverse_hover"]=options.hover.automaticinverse}if(options.out){var interactive_out=options.out.interactive;this[reference+"_activated_out"]=[];this[reference+"_linked_out"]=options.out.linked;this[reference+"_max_activated_out"]=options.out.max_activated;this[reference+"_deactivable_out"]=options.out.deactivable;this[reference+"_less_out"]=options.out.less;this[reference+"_plus_out"]=options.out.plus;this[reference+"_automatic_out"]=options.out.automatic;this[reference+"_automaticpause_out"]=options.out.automaticpause;this[reference+"_automaticinverse_out"]=options.out.automaticinverse}if(options.interaction){this[reference+"_prevsteps"]=typeof(options.interaction.prevsteps)!="undefined"?options.interaction.prevsteps:1;this[reference+"_nextsteps"]=typeof(options.interaction.nextsteps)!="undefined"?options.interaction.nextsteps:1;this[reference+"_prevtosteps"]=options.interaction.prevtosteps;this[reference+"_nexttosteps"]=options.interaction.nexttosteps;this[reference+"_cycle"]=options.interaction.cycle}else{this[reference+"_prevsteps"]=1;this[reference+"_nextsteps"]=1}mg_initLinks(reference,interactive_click,interactive_hover,interactive_out);if(activated.length>0){for(var i in activated){mg_setState(reference,activated[i],"_init",false,false)}}else{mg_setState(reference,null,"_init",false,false)}mg_automatic(reference,"_click");mg_automatic(reference,"_over");mg_automatic(reference,"_out")}$.ajaxSetup({cache:false});function mg_automatic(reference,append){var time=this[reference+"_automatic"+append];var inverse=this[reference+"_automaticinverse"+append];if(time!=undefined){clearInterval(this[reference+"_timeout"+append]);clearInterval(this[reference+"_timeoutpause"+append]);if(inverse){this[reference+"_timeout"+append]=this.setInterval(function(){mg_prev(reference,false)},time)}else{this[reference+"_timeout"+append]=this.setInterval(function(){mg_next(reference,false)},time)}}}function mg_automaticpause(reference,append){var time=this[reference+"_automaticpause"+append];if(time!=undefined){clearInterval(this[reference+"_timeout"+append]);clearInterval(this[reference+"_timeoutpause"+append]);this[reference+"_timeoutpause"+append]=this.setInterval(function(){mg_automatic(reference,append)},time)}}function mg_setState(reference,num,append,alsolinked,pauseautomatic){var time=this[reference+"_automatic"+append];var func=this[reference+append];if(append=="_init"){append="_click"}var old_target=this[reference+"_target"+append];var target=this[reference+"_target"+append]=num;var deactivable=this[reference+"_deactivable"+append];if(func!=undefined){var activated=this[reference+"_activated"+append];var deactivated=mg_deactivate(reference,num,append);var less=this[reference+"_less"+append];var plus=this[reference+"_plus"+append];var cycle=this[reference+"_cycle"];var prevsteps=this[reference+"_prevsteps"];var nextsteps=this[reference+"_nextsteps"];var prevtosteps=this[reference+"_prevtosteps"];var nexttosteps=this[reference+"_nexttosteps"];var multiple=mg_set_mutiple(reference,target,old_target,prevsteps,nextsteps,less,plus,prevtosteps,nexttosteps,cycle);func(reference,activated,deactivated,prevsteps,nextsteps,multiple,cycle);if(!deactivable){for(var i=0;i<activated.length;i++){mg_enableTextSelect($("#"+reference+"-"+activated[i]))}mg_disableTextSelect($("#"+reference+"-"+deactivated))}}if(alsolinked){var linked=this[reference+"_linked"+append];for(var i in linked){mg_setState(linked[i],num,append,false,true)}}if(pauseautomatic){mg_automaticpause(reference,append)}}function mg_set_mutiple(reference,target,old_target,prevsteps,nextsteps,less,plus,prevtosteps,nexttosteps,cycle){mg_checkPrev(reference,prevsteps,nextsteps,less,plus,prevtosteps,nexttosteps,cycle);mg_checkNext(reference,prevsteps,nextsteps,less,plus,prevtosteps,nexttosteps,cycle);if(plus+less>0){var length=$("[id^="+reference+"-]:not([id*=prev]):not([id*=next]):not([id*=first]):not([id*=last])").length;var multiple_activated=mg_mapNum(target,less,plus,length,cycle);var multiple_old_activated=mg_mapNum(old_target,less,plus,length,cycle);var dist=mg_findNearestDistance(target,old_target,length,cycle);var multiple={};multiple.activated=multiple_activated;multiple.old_activated=multiple_old_activated;multiple.less=less;multiple.plus=plus;multiple.distance=dist;multiple.jumped=dist;multiple.before_in=[];multiple.before_out=[];multiple.after_in=[];multiple.after_out=[];multiple.direction=1;if(old_target==null){return multiple}if(dist>0){multiple.direction=1;for(var i=0;i<Math.abs(dist);i++){multiple.after_in.unshift(multiple_activated[multiple_old_activated.length-i-1]);multiple.before_out.unshift(multiple_old_activated[dist-i-1])}}else{multiple.direction=0;for(var i=0;i<Math.abs(dist);i++){multiple.before_in.push(multiple_activated[-dist-i-1]);multiple.after_out.push(multiple_old_activated[multiple_old_activated.length-i-1])}}return multiple}else{return null}}function mg_deactivate(reference,num,append){var activated=this[reference+"_activated"+append];var max_activated=this[reference+"_max_activated"+append];var deactivable=this[reference+"_deactivable"+append];var spliced=null;if(num!=null){var idx=$.inArray(num,activated);if(idx!=-1){if(deactivable){spliced=parseFloat(activated.splice(idx,1))}}else{if(activated.length>=max_activated){spliced=parseFloat(activated.splice(activated.length-1,1))}activated.unshift(num)}}return spliced}function mg_initLinks(reference,interactive_click,interactive_hover,interactive_out){var num=0;while($("#"+reference+"-"+num).length!=0){if(interactive_click){mg_disableTextSelect($("#"+reference+"-"+num));$("#"+reference+"-"+num).live("click",function(){var half=$(this).attr("id").lastIndexOf("-");var reference=$(this).attr("id").slice(0,half);mg_setState(reference,parseFloat($(this).attr("id").slice(half+1)),"_click",true,true);return false})}if(interactive_hover){$("#"+reference+"-"+num).live("mouseenter",function(){var half=$(this).attr("id").lastIndexOf("-");var reference=$(this).attr("id").slice(0,half);mg_setState(reference,parseFloat($(this).attr("id").slice(half+1)),"_hover",true,true);return false})}if(interactive_out){$("#"+reference+"-"+num).live("mouseleave",function(){var half=$(this).attr("id").lastIndexOf("-");var reference=$(this).attr("id").slice(0,half);mg_setState(reference,parseFloat($(this).attr("id").slice(half+1)),"_out",true,true);return false})}num++}mg_disableTextSelect($("#"+reference+"-prev"));$("#"+reference+"-prev").live("click",function(){var half=$(this).attr("id").lastIndexOf("-");mg_prev(reference,true);return false});mg_disableTextSelect($("#"+reference+"-next"));$("#"+reference+"-next").live("click",function(){var half=$(this).attr("id").lastIndexOf("-");mg_next(reference,true);return false});mg_disableTextSelect($("#"+reference+"-first"));$("#"+reference+"-first").live("click",function(){var half=$(this).attr("id").lastIndexOf("-");mg_setState(reference,0,"_click",true,true);return false});mg_disableTextSelect($("#"+reference+"-last"));$("#"+reference+"-last").live("click",function(){var half=$(this).attr("id").lastIndexOf("-");mg_setState(reference,$("[id^="+reference+"-]:not([id*=prev]):not([id*=next]):not([id*=first]):not([id*=last])").length-1,"_click",true,true);return false})}function mg_prev(reference,pauseautomatic){var append="_click";var cycle=this[reference+"_cycle"];var length=$("[id^="+reference+"-]:not([id*=prev]):not([id*=next]):not([id*=first]):not([id*=last])").length;var prevsteps=this[reference+"_prevsteps"];var prevtosteps=this[reference+"_prevtosteps"];var target=parseFloat(this[reference+"_target_click"])-prevsteps;var less=this[reference+"_less"+append];var plus=this[reference+"_plus"+append];if(prevtosteps&&!cycle){if(target<0-less){target=0-less}}else{if(target<0){if(cycle){target=length-Math.abs(target)}else{target=0}}}mg_setState(reference,target,append,true,pauseautomatic)}function mg_next(reference,pauseautomatic){var append="_click";var cycle=this[reference+"_cycle"];var length=$("[id^="+reference+"-]:not([id*=prev]):not([id*=next]):not([id*=first]):not([id*=last])").length;var nextsteps=this[reference+"_nextsteps"];var nexttosteps=this[reference+"_nexttosteps"];var target=this[reference+"_target"+append]+nextsteps;var less=this[reference+"_less"+append];var plus=this[reference+"_plus"+append];if(nexttosteps&&!cycle){if(target>length-1+plus){target=length-1+plus}}else{if(target>length-1){if(cycle){target=Math.abs(target)-length}else{target=this[reference+"_target_click"]}}}mg_setState(reference,target,append,true,pauseautomatic)}function mg_checkPrev(reference,prevsteps,nextsteps,less,plus,prevtosteps,nexttosteps,cycle){var length=$("[id^="+reference+"-]:not([id*=prev]):not([id*=next]):not([id*=first]):not([id*=last])").length;if(!cycle){var target=parseFloat(this[reference+"_target_click"])-prevsteps;if(prevtosteps){if(target<0-less-plus){var func=this[reference+"_prevhide"];if(func!=undefined){func(reference,prevsteps)}}else{var func=this[reference+"_prevshow"];if(func!=undefined){func(reference,prevsteps)}}}else{if(target<0){var func=this[reference+"_prevhide"];if(func!=undefined){func(reference,prevsteps)}}else{var func=this[reference+"_prevshow"];if(func!=undefined){func(reference,prevsteps)}}}}}function mg_checkNext(reference,prevsteps,nextsteps,less,plus,prevtosteps,nexttosteps,cycle){var length=$("[id^="+reference+"-]:not([id*=prev]):not([id*=next]):not([id*=first]):not([id*=last])").length;if(!cycle){var target=this[reference+"_target_click"]+nextsteps;if(nexttosteps){if(target>length-less-plus-1){var func=this[reference+"_nexthide"];if(func!=undefined){func(reference,nextsteps)}}else{var func=this[reference+"_nextshow"];if(func!=undefined){func(reference,nextsteps)}}}else{if(target>length-1){var func=this[reference+"_nexthide"];if(func!=undefined){func(reference,nextsteps)}}else{var func=this[reference+"_nextshow"];if(func!=undefined){func(reference,nextsteps)}}}}}function mg_mapNum(num,less,plus,max,cycle){var arr=[];for(var i=-less;i<=plus;i++){if(num+i<max||cycle){if(num+i<0&&cycle){arr.push(max-(-num-i))}else{if(num+i>=max&&cycle){arr.push(num+i-max)}else{arr.push(num+i)}}}else{arr.push(null)}}return arr}function mg_mapDistance(center,num){return center-num}function mg_mapDistanceReverse(center,num,max,min){var max_distance=max-min;if(num==center){return center}else{if(num<max_distance/2){return -num}else{if(num>max_distance/2){return(max_distance-num-1)}else{return max_distance/2}}}}function mg_findNearestDistance(i,z,max,cycle){var maxDist=max/2;if(!cycle||(i-z<maxDist&&i-z>-maxDist)){return(i-z)}else{if(i-z>maxDist){if(z>i){return(-i-(max-z))}else{return(-z-(max-i))}}else{if(i-z<-maxDist){if(z>i){return(i+(max-z))}else{return(z+(max-i))}}}}}function mg_disableTextSelect(obj){obj.each(function(){this.onselectstart=function(){return false};this.unselectable="on";jQuery(this).css("user-select","none");jQuery(this).css("-o-user-select","none");jQuery(this).css("-moz-user-select","none");jQuery(this).css("-khtml-user-select","none");jQuery(this).css("-webkit-user-select","none")})}function mg_enableTextSelect(obj){obj.each(function(){this.onselectstart=function(){};this.unselectable="off";jQuery(this).css("user-select","text");jQuery(this).css("-o-user-select","text");jQuery(this).css("-moz-user-select","text");jQuery(this).css("-khtml-user-select","text");jQuery(this).css("-webkit-user-select","text")})};