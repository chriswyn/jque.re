(function(){var exports=this;var IceEmdashPlugin=function(ice_instance){this._ice=ice_instance};IceEmdashPlugin.prototype={keyDown:function(e){if(ice.dom.isBrowser("mozilla")){if(e.keyCode===109){return this.convertEmdash(e)}}else{if(e.keyCode===189){return this.convertEmdash(e)}}return true},convertEmdash:function(e){var range=this._ice.getCurrentRange();if(range.collapsed){try{range.moveStart(ice.dom.CHARACTER_UNIT,-1);var startBlock=ice.dom.getParents(range.startContainer,this._ice.blockEl)[0];var endBlock=ice.dom.getParents(range.endContainer,this._ice.blockEl)[0];if(startBlock===endBlock&&!this._ice.getIceNode(range.startContainer,"deleteType")){var fragment=range.cloneContents();var c=ice.dom.getNodeTextContent(fragment);if(c==="-"){range.extractContents();range.collapse();var mdash=this._ice.env.document.createTextNode("\u2014");this._ice.insert(mdash,range);range=this._ice.getCurrentRange();range.moveStart(ice.dom.CHARACTER_UNIT,1);range.collapse(true);this._ice.env.selection.addRange(range);return false}}}catch(e){}range.collapse()}return true}};ice.dom.noInclusionInherits(IceEmdashPlugin,ice.IcePlugin);exports._plugin.IceEmdashPlugin=IceEmdashPlugin}).call(this.ice);